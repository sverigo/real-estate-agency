@using PagedList;
@using PagedList.Mvc;
@using real_estate_agency.Infrastructure;
@using real_estate_agency.Models.ViewModels;
@model MainPageViewModel

@foreach (var item in Model.PagedListModel)
{
    var src = item.PrevImage;
    if (item.PrevImage == null)
    {
        src = "../Content/images/nophoto.png";
    }
    <div class="box col-md-6 ">
        @if (PermissionDirectory.UserCanEditDeleteAd(User, item))
        {
            @Html.ActionLink(" ", "Edit", "Ads", new { id = item.Id }, new { @class = "edit" })
            @Html.ActionLink(" ", "Remove", "Ads", new { id = item.Id }, new { @class = "remove" })
        }
        @if (!PermissionDirectory.IsOwnerOfAd(User, item))
        {
            <div id="marks-@item.Id">
                @{Html.RenderAction("Marks", "Ads", new { id = item.Id });}
            </div>
        }
        <p class="title">@item.Title</p>
        <div class="row">
            <div class="img-box">
                <img src="@src">
            </div>
            <div class="text-box">
                <p><strong>Тип:</strong> @item.Type</p>
                <p><strong>Адрес:</strong> @item.Address</p>
                <p><strong>Стоимость:</strong> @item.Value @item.Currency</p>
                <p>@Html.ActionLink("Подробнее", "Details", "Ads", new { id = item.Id }, new { @class = "" })</p>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
                }
<div id="pagesSwitch" class="pagesSwitch">
    @Html.PagedListPager((IPagedList)Model.PagedListModel, page => Url.Action("AdFilter", "Home", new
{
    Currency = Model.Currency ?? "",
    MaxArea = Model.MaxArea,
    MinArea = Model.MinArea,
    MaxQuantity = Model.MaxQuantity,
    MinQuantity = Model.MinQuantity,
    MinFloor = Model.MinFloor,
    MaxFloor = Model.MaxFloor,
    MaxRoomsCount = Model.MaxRoomsCount,
    MinRoomsCount = Model.MinRoomsCount,
    Page = page
}),
        PagedListRenderOptions.EnableUnobtrusiveAjaxReplacing(new AjaxOptions { HttpMethod = "Post", UpdateTargetId = "results" }))
</div>


